<?xml version="1.0" encoding="UTF-8" ?>

<project default="help">

    <!-- Import helper targets if called here directly. -->
    <if>
         <available file="help.xml" />
         <then>
             <import file="help.xml" />
         </then>
     </if>

    <!-- Build release package. -->
    <target name="build-dist-subsite-package" description="Build subsite source code release package." depends="build-dist-subsite">
        <mkdir dir="${project.release.path}" />
        <exec command="tar -czf ${project.release.path}/${project.release.name}.tar.gz ${phing.subsite.build.dir}" />
    </target>

    <!-- Build test package. -->
    <target name="build-test-subsite-package" description="Build subsite tests code release package.">
        <mkdir dir="${project.release.path}" />
    </target>

    <!-- Create code base. -->
    <target
        name="build-dev-subsite"
        description="Build local version of subsite without install."
        depends="
            subsite-site-backup,
            platform-delete,
            platform-make,
            subsite-resources-link,
            subsite-composer-install,
            test-behat-setup-link,
            test-behat-setup,
            platform-update-htaccess,
            test-phpcs-setup,
            subsite-modules-devel-dl,
            subsite-site-restore"
    />

    <!-- Build code base with backup restore. -->
    <target name="build-keep" description="Build local version of subsite with backup and restore.">
        <!-- Execute build-dev with automatic rebuild enabled. -->
        <phingcall target="build-dev">
            <property name="platform.rebuild.auto" value="1" override="true"/>
        </phingcall>
    </target>

</project>
